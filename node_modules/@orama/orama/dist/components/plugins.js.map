{"version":3,"sources":["../../src/components/plugins.ts"],"sourcesContent":["import type { AnyOrama, OramaPlugin } from '../types.js'\nimport { createError } from '../errors.js'\n\nexport type AvailablePluginHooks = (typeof AVAILABLE_PLUGIN_HOOKS)[number]\n\nexport const AVAILABLE_PLUGIN_HOOKS = [\n  'beforeInsert',\n  'afterInsert',\n  'beforeRemove',\n  'afterRemove',\n  'beforeUpdate',\n  'afterUpdate',\n  'beforeSearch',\n  'afterSearch',\n  'beforeInsertMultiple',\n  'afterInsertMultiple',\n  'beforeRemoveMultiple',\n  'afterRemoveMultiple',\n  'beforeUpdateMultiple',\n  'afterUpdateMultiple',\n  'beforeLoad',\n  'afterLoad',\n  'afterCreate'\n] as const\n\nexport async function getAllPluginsByHook<T extends AnyOrama>(\n  orama: T,\n  hook: AvailablePluginHooks\n): Promise<OramaPlugin[]> {\n  const pluginsToRun: OramaPlugin[] = []\n  const pluginsLength = orama.plugins?.length\n\n  if (!pluginsLength) {\n    return pluginsToRun\n  }\n\n  for (let i = 0; i < pluginsLength; i++) {\n    try {\n      const plugin = await orama.plugins[i]\n      if (typeof plugin[hook] === 'function') {\n        pluginsToRun.push(plugin[hook] as OramaPlugin)\n      }\n    } catch (error) {\n      console.error('Caught error in getAllPluginsByHook:', error)\n      throw createError('PLUGIN_CRASHED')\n    }\n  }\n\n  return pluginsToRun\n}\n"],"names":["createError","AVAILABLE_PLUGIN_HOOKS","getAllPluginsByHook","orama","hook","pluginsToRun","pluginsLength","plugins","length","i","plugin","push","error","console"],"mappings":"AACA,SAASA,WAAW,QAAQ,eAAc;AAI1C,OAAO,MAAMC,yBAAyB;IACpC;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD,CAAS;AAEV,OAAO,eAAeC,oBACpBC,KAAQ,EACRC,IAA0B,EACF;QAEFD;IADtB,MAAME,eAA8B,EAAE;IACtC,MAAMC,gBAAgBH,CAAAA,iBAAAA,MAAMI,OAAO,cAAbJ,4BAAAA,KAAAA,IAAAA,eAAeK,MAAM;IAE3C,IAAI,CAACF,eAAe;QAClB,OAAOD;IACT,CAAC;IAED,IAAK,IAAII,IAAI,GAAGA,IAAIH,eAAeG,IAAK;QACtC,IAAI;YACF,MAAMC,SAAS,MAAMP,MAAMI,OAAO,CAACE,EAAE;YACrC,IAAI,OAAOC,MAAM,CAACN,KAAK,KAAK,YAAY;gBACtCC,aAAaM,IAAI,CAACD,MAAM,CAACN,KAAK;YAChC,CAAC;QACH,EAAE,OAAOQ,OAAO;YACdC,QAAQD,KAAK,CAAC,wCAAwCA;YACtD,MAAMZ,YAAY,kBAAiB;QACrC;IACF;IAEA,OAAOK;AACT,CAAC"}